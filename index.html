<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Mean, Median & Mode Calculator</title>

  <style>
    :root {
      --bg: #0f172a;
      --card: #020617;
      --accent: #38bdf8;
      --accent-soft: rgba(56, 189, 248, 0.15);
      --text: #e5e7eb;
      --muted: #9ca3af;
      --danger: #f97373;
      --border: #1f2937;
      --radius: 12px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
    }

    body {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at top, #1e293b 0, #020617 55%);
      color: var(--text);
      padding: 20px;
    }

    .app {
      width: 100%;
      max-width: 900px;
      background: linear-gradient(135deg, #7000ff, #020617);
      border-radius: 18px;
      border: 1px solid rgba(148, 163, 184, 0.15);
      box-shadow:
        0 20px 60px rgba(15, 23, 42, 0.9),
        0 0 0 1px rgba(148, 163, 184, 0.05);
      padding: 22px 24px 20px;
    }

    .app-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 18px;
      gap: 16px;
    }

    .title-block h1 {
      font-size: 1.25rem;
      letter-spacing: 0.02em;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .badge {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      border-radius: 999px;
      padding: 3px 9px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      color: var(--muted);
    }

    .subtitle {
      font-size: 0.8rem;
      color: var(--muted);
      margin-top: 4px;
    }

    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      justify-content: flex-end;
    }

    .select-wrapper {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 0.8rem;
      color: var(--muted);
    }

    select {
      background-color: #020617;
      color: var(--text);
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.55);
      padding: 6px 14px;
      font-size: 0.8rem;
      outline: none;
      cursor: pointer;
    }

    select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.3);
    }

    .btn {
      border: none;
      border-radius: 999px;
      padding: 7px 16px;
      font-size: 0.8rem;
      font-weight: 500;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: transform 0.08s ease, box-shadow 0.08s ease, background 0.15s;
      white-space: nowrap;
    }

    .btn-primary {
      background: radial-gradient(circle at 10% 0, #38bdf8, #0ea5e9);
      color: #0b1120;
      box-shadow:
        0 12px 30px rgba(56, 189, 248, 0.3),
        0 0 0 1px rgba(15, 23, 42, 0.7);
    }

    .btn-ghost {
      background: rgba(15, 23, 42, 0.9);
      color: var(--muted);
      border: 1px dashed rgba(148, 163, 184, 0.5);
    }

    .btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 10px 22px rgba(15, 23, 42, 0.7);
    }

    .btn:active {
      transform: translateY(0);
      box-shadow: none;
    }

    .content {
      display: grid;
      grid-template-columns: minmax(0, 3fr) minmax(260px, 2fr);
      gap: 18px;
    }

    @media (max-width: 780px) {
      .content {
        grid-template-columns: 1fr;
      }

      .app {
        padding: 18px 16px;
      }

      .app-header {
        flex-direction: column;
        align-items: stretch;
      }

      .controls {
        justify-content: flex-start;
      }
    }

    .card {
      background: radial-gradient(circle at top left, #020617, #020617);
      border-radius: var(--radius);
      border: 1px solid rgba(148, 163, 184, 0.18);
      padding: 14px 14px 12px;
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(
        circle at top right,
        rgba(56, 189, 248, 0.24),
        transparent 55%
      );
      opacity: 0.18;
      pointer-events: none;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 8px;
      position: relative;
      z-index: 1;
    }

    .card-header h2 {
      font-size: 0.88rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--muted);
    }

    .helper {
      font-size: 0.75rem;
      color: var(--muted);
      margin-bottom: 8px;
      position: relative;
      z-index: 1;
    }

    .helper span {
      color: var(--accent);
      font-weight: 500;
    }

    .table-wrapper {
      border-radius: 10px;
      overflow: hidden;
      border: 1px solid rgba(148, 163, 184, 0.3);
      background: rgba(15, 23, 42, 0.9);
      box-shadow: inset 0 1px 0 rgba(148, 163, 184, 0.25);
      position: relative;
      z-index: 1;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.8rem;
    }

    thead {
      background: rgba(15, 23, 42, 0.96);
    }

    th,
    td {
      padding: 6px 8px;
      text-align: left;
      border-bottom: 1px solid rgba(30, 64, 175, 0.5);
    }

    th {
      font-weight: 500;
      color: var(--muted);
    }

    tbody tr:nth-child(odd) {
      background: rgba(15, 23, 42, 0.96);
    }

    tbody tr:nth-child(even) {
      background: rgba(15, 23, 42, 0.92);
    }

    input[type="number"] {
      width: 100%;
      padding: 4px 6px;
      border-radius: 6px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      background: #020617;
      color: var(--text);
      font-size: 0.8rem;
      outline: none;
    }

    input[type="number"]:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.25);
    }

    .remove-row-btn {
      border-radius: 999px;
      border: none;
      padding: 2px 8px;
      font-size: 0.7rem;
      cursor: pointer;
      background: rgba(15, 23, 42, 0.9);
      color: var(--muted);
      border: 1px solid rgba(148, 163, 184, 0.5);
    }

    .remove-row-btn:hover {
      background: rgba(15, 23, 42, 1);
      color: var(--danger);
      border-color: rgba(248, 113, 113, 0.7);
    }

    .footer-actions {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
      gap: 8px;
      position: relative;
      z-index: 1;
    }

    .mini-note {
      font-size: 0.7rem;
      color: var(--muted);
      opacity: 0.9;
    }

    /* Hide frequency column when Mean is selected */
    .hide-frequency th:nth-child(2),
    .hide-frequency td:nth-child(2) {
      display: none;
    }

    .result-card {
      position: relative;
      z-index: 1;
    }

    .result-main {
      font-size: 1.5rem;
      font-weight: 600;
      margin-top: 4px;
      margin-bottom: 4px;
      color: var(--accent);
    }

    .result-label {
      font-size: 0.78rem;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: var(--muted);
    }

    .result-details {
      font-size: 0.78rem;
      color: var(--muted);
      margin-top: 8px;
      line-height: 1.4;
    }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 3px 8px;
      border-radius: 999px;
      font-size: 0.7rem;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.4);
      margin-top: 8px;
    }

    .chip span {
      color: var(--accent);
    }

    .error {
      margin-top: 8px;
      font-size: 0.76rem;
      color: var(--danger);
    }

    .pill-group {
      display: inline-flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 6px;
    }

    .pill {
      padding: 3px 7px;
      border-radius: 999px;
      background: var(--accent-soft);
      font-size: 0.7rem;
      color: #e0f2fe;
      border: 1px solid rgba(56, 189, 248, 0.7);
    }
  </style>
</head>
<body>
  <div class="app">
    <header class="app-header">
      <div class="title-block">
        <h1>
          Statistics Tool
          <span class="badge">Mean • Median • Mode</span>
        </h1>
        <p class="subtitle">
          Enter midpoints (and frequencies when needed). Calculator will adapt based on your selection.
        </p>
      </div>

      <div class="controls">
        <div class="select-wrapper">
          Method:
          <select id="calcType">
            <option value="mean">Mean (Midpoints only)</option>
            <option value="median">Median (Midpoint + Frequency)</option>
            <option value="mode">Mode (Midpoint + Frequency)</option>
          </select>
        </div>
        <button class="btn btn-primary" id="calculateBtn">
          ⚙️ Calculate
        </button>
      </div>
    </header>

    <section class="content">
      <!-- Left: Data Input -->
      <div class="card">
        <div class="card-header">
          <h2>Data Table</h2>
        </div>
        <p class="helper" id="helperText">
          For <span>Mean</span>, only midpoint values are used. Each midpoint is treated with equal weight.
        </p>

        <div class="table-wrapper">
          <table id="dataTable">
            <thead>
              <tr>
                <th>Midpoint</th>
                <th>Frequency</th>
                <th style="width: 60px;">Actions</th>
              </tr>
            </thead>
            <tbody id="tableBody">
              <!-- JS will add rows -->
            </tbody>
          </table>
        </div>

        <div class="footer-actions">
          <button class="btn btn-ghost" id="addRowBtn">＋ Add row</button>
          <p class="mini-note">
            Tip: Leave empty rows if not needed, they will be ignored.
          </p>
        </div>
      </div>

      <!-- Right: Result -->
      <div class="card result-card">
        <div class="card-header">
          <h2>Result</h2>
        </div>
        <div id="resultArea">
          <p class="result-label">Waiting for input…</p>
          <div class="pill-group">
            <div class="pill">Choose a method</div>
            <div class="pill">Fill the table</div>
            <div class="pill">Click Calculate</div>
          </div>
        </div>
      </div>
    </section>
  </div>

  <script>
    // Utility: Format number nicely
    function formatNumber(num) {
      if (Number.isNaN(num) || !Number.isFinite(num)) return "—";
      const fixed = num.toFixed(4);
      return fixed.replace(/\.?0+$/, "");
    }

    const calcTypeSelect = document.getElementById("calcType");
    const tableBody = document.getElementById("tableBody");
    const dataTable = document.getElementById("dataTable");
    const helperText = document.getElementById("helperText");
    const addRowBtn = document.getElementById("addRowBtn");
    const calculateBtn = document.getElementById("calculateBtn");
    const resultArea = document.getElementById("resultArea");

    // Initialize with 3 rows
    function initTable() {
      tableBody.innerHTML = "";
      for (let i = 0; i < 3; i++) {
        addRow();
      }
    }

    function addRow(midVal = "", freqVal = "") {
      const tr = document.createElement("tr");

      const midTd = document.createElement("td");
      const midInput = document.createElement("input");
      midInput.type = "number";
      midInput.step = "any";
      midInput.placeholder = "e.g. 10.5";
      midInput.className = "mid-input";
      midInput.value = midVal;
      midTd.appendChild(midInput);

      const freqTd = document.createElement("td");
      const freqInput = document.createElement("input");
      freqInput.type = "number";
      freqInput.step = "1";
      freqInput.min = "0";
      freqInput.placeholder = "e.g. 4";
      freqInput.className = "freq-input";
      freqInput.value = freqVal;
      freqTd.appendChild(freqInput);

      const actionTd = document.createElement("td");
      const removeBtn = document.createElement("button");
      removeBtn.textContent = "✕";
      removeBtn.type = "button";
      removeBtn.className = "remove-row-btn";
      removeBtn.addEventListener("click", () => {
        if (tableBody.rows.length > 1) {
          tr.remove();
        }
      });
      actionTd.appendChild(removeBtn);

      tr.appendChild(midTd);
      tr.appendChild(freqTd);
      tr.appendChild(actionTd);

      tableBody.appendChild(tr);
    }

    function updateModeUI() {
      const mode = calcTypeSelect.value;

      if (mode === "mean") {
        dataTable.classList.add("hide-frequency");
        helperText.innerHTML =
          'For <span>Mean</span>, only midpoint values are used (frequency is ignored). Each midpoint is equally weighted.';
      } else if (mode === "median") {
        dataTable.classList.remove("hide-frequency");
        helperText.innerHTML =
          'For <span>Median</span>, enter midpoint and frequency. The calculator expands data conceptually and finds the median.';
      } else if (mode === "mode") {
        dataTable.classList.remove("hide-frequency");
        helperText.innerHTML =
          'For <span>Mode</span>, enter midpoint and frequency. The midpoint with highest frequency is the mode (ties supported).';
      }
    }

    function readData() {
      const rows = Array.from(tableBody.querySelectorAll("tr"));
      const data = [];

      rows.forEach((row) => {
        const midInput = row.querySelector(".mid-input");
        const freqInput = row.querySelector(".freq-input");

        const mid = parseFloat(midInput.value);
        const freqRaw = parseFloat(freqInput.value);

        if (!Number.isNaN(mid)) {
          data.push({
            mid,
            freq: Number.isNaN(freqRaw) || freqRaw <= 0 ? 1 : freqRaw,
          });
        }
      });

      return data;
    }

    function calculateMean(data) {
      if (data.length === 0) {
        return null;
      }
      const sum = data.reduce((acc, item) => acc + item.mid, 0);
      return sum / data.length;
    }

    function calculateMedianFromExpanded(data) {
      if (data.length === 0) return null;

      // Build expanded array based on frequency
      const values = [];
      data.forEach((item) => {
        const count = Math.max(1, Math.round(item.freq));
        for (let i = 0; i < count; i++) {
          values.push(item.mid);
        }
      });

      if (values.length === 0) return null;

      values.sort((a, b) => a - b);
      const n = values.length;

      if (n % 2 === 1) {
        return values[(n - 1) / 2];
      } else {
        const mid1 = values[n / 2 - 1];
        const mid2 = values[n / 2];
        return (mid1 + mid2) / 2;
      }
    }

    function calculateMode(data) {
      if (data.length === 0) return null;

      const freqMap = new Map();
      data.forEach((item) => {
        const key = item.mid;
        const existing = freqMap.get(key) || 0;
        freqMap.set(key, existing + item.freq);
      });

      let maxFreq = -Infinity;
      freqMap.forEach((f) => {
        if (f > maxFreq) maxFreq = f;
      });

      const modes = [];
      freqMap.forEach((f, mid) => {
        if (f === maxFreq) {
          modes.push({ mid, freq: f });
        }
      });

      return { maxFreq, modes };
    }

    function showError(message) {
      resultArea.innerHTML = `
        <p class="result-label">Error</p>
        <p class="error">${message}</p>
      `;
    }

    function renderResult() {
      const mode = calcTypeSelect.value;
      const data = readData();

      if (data.length === 0) {
        showError("Please enter at least one midpoint value.");
        return;
      }

      if (mode === "mean") {
        const mean = calculateMean(data);
        if (mean === null) {
          showError("Unable to calculate mean. Check your inputs.");
          return;
        }

        resultArea.innerHTML = `
          <p class="result-label">Mean (Midpoints only)</p>
          <p class="result-main">${formatNumber(mean)}</p>
          <p class="result-details">
            • Number of midpoints used: <strong>${data.length}</strong><br />
            • All midpoints are assumed to have equal weight (frequency = 1).
          </p>
          <div class="chip">
            ✔ <span>Tip:</span> For grouped data mean with class & frequency, you can modify this logic easily.
          </div>
        `;
      } else if (mode === "median") {
        const median = calculateMedianFromExpanded(data);
        if (median === null) {
          showError("Unable to calculate median. Check your inputs.");
          return;
        }

        const totalFreq = data.reduce((acc, item) => acc + Math.max(1, Math.round(item.freq)), 0);

        resultArea.innerHTML = `
          <p class="result-label">Median (From midpoint & frequency)</p>
          <p class="result-main">${formatNumber(median)}</p>
          <p class="result-details">
            • Total frequency (Σf): <strong>${totalFreq}</strong><br />
            • Conceptually, data is expanded by repeating each midpoint according to its frequency, then median is found.
          </p>
          <div class="chip">
            ℹ <span>Note:</span> This is equivalent to median of discrete distribution on midpoints.
          </div>
        `;
      } else if (mode === "mode") {
        const result = calculateMode(data);
        if (!result) {
          showError("Unable to calculate mode. Check your inputs.");
          return;
        }

        const { maxFreq, modes } = result;
        const modeValues = modes.map((m) => formatNumber(m.mid)).join(", ");

        const pillHtml = modes
          .map(
            (m) => `<span class="pill">Midpoint ${formatNumber(m.mid)} (f = ${formatNumber(m.freq)})</span>`
          )
          .join("");

        resultArea.innerHTML = `
          <p class="result-label">Mode (From midpoint & frequency)</p>
          <p class="result-main">${modeValues}</p>
          <p class="result-details">
            • Highest frequency: <strong>${formatNumber(maxFreq)}</strong><br />
            • ${
              modes.length > 1
                ? "There are multiple modes (multimodal distribution)."
                : "Single modal midpoint found."
            }
          </p>
          <div class="pill-group">
            ${pillHtml}
          </div>
        `;
      }
    }

    // Event listeners
    calcTypeSelect.addEventListener("change", () => {
      updateModeUI();
      resultArea.innerHTML = `
        <p class="result-label">Mode changed to: ${calcTypeSelect.value.toUpperCase()}</p>
        <p class="result-details">
          Update your inputs if needed, then press <strong>Calculate</strong> again.
        </p>
      `;
    });

    addRowBtn.addEventListener("click", () => addRow());
    calculateBtn.addEventListener("click", renderResult);

    // Initial UI setup
    initTable();
    updateModeUI();
  </script>
</body>
</html>
